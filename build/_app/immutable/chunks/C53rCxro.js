import{S as h,T as v,w as y,V as m,D as _,N as i,W as w}from"./CngUWQ3u.js";function g(e,r,t=r){var n=new WeakSet;h(e,"input",async l=>{var a=l?e.defaultValue:e.value;if(a=u(e)?d(a):a,t(a),i!==null&&n.add(i),await v(),a!==(a=r())){var c=e.selectionStart,s=e.selectionEnd;e.value=a??"",s!==null&&(e.selectionStart=c,e.selectionEnd=Math.min(s,e.value.length))}}),(_&&e.defaultValue!==e.value||y(r)==null&&e.value)&&(t(u(e)?d(e.value):e.value),i!==null&&n.add(i)),m(()=>{var l=r();if(e===document.activeElement){var a=w??i;if(n.has(a))return}u(e)&&l===d(e.value)||e.type==="date"&&!l&&!e.value||l!==e.value&&(e.value=l??"")})}function u(e){var r=e.type;return r==="number"||r==="range"}function d(e){return e===""?null:+e}let o=null;async function q(e){return o||(o=fetch("/content-index.json").then(t=>t.json()),o)}const f=e=>e.toLowerCase();function S(e,r,t=["title","summary","tech","keywords"]){if(!r.trim())return e;const n=f(r);return e.filter(l=>t.some(a=>{const c=l[a];return Array.isArray(c)?c.some(s=>f(String(s)).includes(n)):typeof c=="string"?f(c).includes(n):!1}))}function k(e,r){let t=e.slice();if(r.type&&(t=t.filter(n=>n.type===r.type)),r.techAll?.length){const n=new Set(r.techAll.map(f));t=t.filter(l=>{const a=new Set(l.tech.map(f));for(const c of n)if(!a.has(c))return!1;return!0})}if(r.techAny?.length){const n=new Set(r.techAny.map(f));t=t.filter(l=>l.tech.some(a=>n.has(f(a))))}if(r.keywordsAny?.length){const n=new Set(r.keywordsAny.map(f));t=t.filter(l=>l.keywords?.some(a=>n.has(f(a))))}return r.dateFrom&&(t=t.filter(n=>(n.date??"")>=r.dateFrom)),r.dateTo&&(t=t.filter(n=>(n.date??"")<=r.dateTo)),t}function A(e,r="date",t="desc"){const n=e.slice(),l=(a,c)=>t==="asc"?a.localeCompare(c):c.localeCompare(a);return r==="date"?n.sort((a,c)=>l(a.date??"",c.date??"")):n.sort((a,c)=>l(a.title,c.title)),n}function x(e,r){let t=e;return r.filter&&(t=k(t,r.filter)),r.q&&(t=S(t,r.q,r.fields)),t=A(t,r.sortBy??"date",r.sortDir??"desc"),t}export{g as b,q as l,x as q};
